<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>¡Feliz Cumpleaños, Maria Antonia! — 23</title>
  <meta name="description" content="Landing móvil con parallax, motion graphics y animaciones sutiles para celebrar los 23 de Maria Antonia." />
  <meta name="theme-color" content="#0F172A" />
  <style>
    :root{
      --bg-dark:#0F172A; /* slate-900 */
      --bg-light:#F8FAFC; /* slate-50 */
      --gold:#F59E0B; /* amber-500 */
      --magenta:#E879F9; /* fuchsia-400 */
      --sky:#38BDF8; /* sky-400 */
      --ink:#0B1220;
      --paper:#ffffff;
      --glass:rgba(255,255,255,0.08);
      --glass-b:rgba(255,255,255,0.16);
      --radius-lg:18px;
      --radius-md:14px;
      --shadow-soft:0 10px 30px rgba(0,0,0,.2);
      --shadow-tiny:0 4px 10px rgba(0,0,0,.12);
      --ease: cubic-bezier(.22,.61,.36,1);
    }
    /* Theme (light/dark) */
    html { color-scheme: dark;}
    body[data-theme="light"]{ --ink:#1E293B; --paper:#F8FAFC; color:#1E293B; background:var(--paper);} 
    body[data-theme="dark"]{ --ink:#E5E7EB; --paper:var(--bg-dark); color:#E5E7EB; background:radial-gradient(1000px 600px at 50% -10%, rgba(248,250,252,.08), transparent 60%), var(--paper);} 

    /* Reset */
    *,*::before,*::after{box-sizing:border-box}
    body{margin:0;font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;overflow-x:hidden}
    h1,h2,h3,p{margin:0 0 .75rem 0}
    img{max-width:100%;display:block;height:auto}
    a{color:inherit}
    button{font:inherit}

    /* Utilities */
    .wrap{width:min(1040px, 92vw); margin-inline:auto}
    .section{position:relative; padding:72px 0}
    .sr-only{position:absolute !important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0}
    .muted{opacity:.8}
    .center{text-align:center}

    /* Header / Theme Toggle */
    header.site{position:fixed; inset:0 0 auto 0; height:56px; display:flex; align-items:center; z-index:40; mix-blend-mode:normal; backdrop-filter:saturate(120%) blur(10px); -webkit-backdrop-filter:saturate(120%) blur(10px); border-bottom:1px solid rgba(255,255,255,.08)}
    header.site .wrap{display:flex; align-items:center; justify-content:space-between}
    .brand{display:flex; align-items:center; gap:.6rem; letter-spacing:.06em; font-weight:700}
    .brand .dot{width:8px; height:8px; border-radius:999px; background:linear-gradient(145deg,var(--gold),var(--magenta))}
    .toggle{display:inline-flex; align-items:center; gap:.5rem; border:1px solid rgba(255,255,255,.2); background:var(--glass); color:inherit; padding:.45rem .7rem; border-radius:999px; cursor:pointer; box-shadow:var(--shadow-tiny)}
    .toggle:focus-visible{outline:2px solid var(--sky); outline-offset:2px}

    /* HERO */
    .hero{min-height:100svh; display:grid; place-items:center; position:relative; overflow:hidden; padding-top:56px}
    .hero .parallax{position:absolute; inset:0; transform-style:preserve-3d; perspective:900px}
    .layer{position:absolute; inset:0; will-change:transform}
    .stars{background:radial-gradient(2px 2px at 20% 40%, rgba(255,255,255,.8), transparent 50%),
                         radial-gradient(1.5px 1.5px at 70% 30%, rgba(255,255,255,.7), transparent 50%),
                         radial-gradient(1.2px 1.2px at 40% 70%, rgba(255,255,255,.65), transparent 50%),
                         radial-gradient(1.8px 1.8px at 80% 60%, rgba(255,255,255,.75), transparent 50%),
                         radial-gradient(1px 1px at 10% 80%, rgba(255,255,255,.6), transparent 50%);
            opacity:.45}
    .glow{background:radial-gradient(60vw 40vh at 50% 20%, rgba(232,121,249,.18), transparent 55%),
                          radial-gradient(50vw 36vh at 50% 80%, rgba(56,189,248,.15), transparent 60%)}

    /* Floating balloons */
    .balloons{pointer-events:none}
    .balloon{position:absolute; width:90px; aspect-ratio:3/4; border-radius:50% 50% 45% 45% / 55% 55% 45% 45%;
             background:radial-gradient(80px 120px at 30% 30%, rgba(255,255,255,.6), rgba(255,255,255,0) 40%),
                        linear-gradient(160deg, rgba(255,255,255,.35), rgba(255,255,255,.05) 30%, rgba(0,0,0,.14) 90%),
                        linear-gradient(145deg, var(--magenta), var(--gold));
             box-shadow: inset 0 0 20px rgba(255,255,255,.12), 0 20px 30px rgba(0,0,0,.28);
             animation: float var(--t,8s) ease-in-out infinite}
    .balloon:after{content:""; position:absolute; inset:auto 0 -22px 0; margin:auto; width:2px; height:26px; background:linear-gradient(transparent, rgba(255,255,255,.5));}
    .balloon:nth-child(1){left:8%; top:60%; --t:9s}
    .balloon:nth-child(2){left:78%; top:30%; --t:7.5s}
    .balloon:nth-child(3){left:65%; top:70%; --t:10s}

    @keyframes float{ 0%,100%{ transform:translateY(0) } 50%{ transform:translateY(-14px) } }

    /* Confetti (subtle) */
    .confetti{position:absolute; inset:0; pointer-events:none}
    .piece{position:absolute; width:6px; height:10px; border-radius:2px; opacity:.7; transform:translateY(-20vh) rotate(0deg); animation: fall linear infinite}
    @keyframes fall{ 100%{ transform: translateY(120vh) rotate(360deg) } }

    .hero-content{position:relative; z-index:2; text-align:center; padding:1rem}
    .title{font-size: clamp(34px, 7vw, 72px); line-height:1.05; letter-spacing:.02em; font-weight:800;
           background:linear-gradient(92deg, var(--gold), var(--magenta), var(--sky));
           background-clip:text; -webkit-background-clip:text; -webkit-text-fill-color:transparent;
           filter: drop-shadow(0 6px 18px rgba(0,0,0,.28));
           animation: titleGlow 8s linear infinite}
    @keyframes titleGlow{ 0%{ text-shadow: 0 0 0 rgba(255,255,255,0) } 50%{ text-shadow: 0 0 24px rgba(255,255,255,.15) } 100%{ text-shadow: 0 0 0 rgba(255,255,255,0) } }

    .subtitle{font-size:clamp(16px, 4.2vw, 22px); opacity:.92; letter-spacing:.04em; animation: fadeInUp .9s var(--ease) both .2s}
    @keyframes fadeInUp{ from{ opacity:0; transform:translateY(10px) } to{ opacity:1; transform:translateY(0) } }

    .scroll-hint{position:absolute; left:50%; bottom:22px; transform:translateX(-50%); display:grid; place-items:center; gap:6px; color:rgba(255,255,255,.9)}
    .chev{width:20px; height:28px; border:2px solid currentColor; border-radius:12px; position:relative}
    .chev:after{content:""; position:absolute; left:50%; top:6px; width:4px; height:6px; transform:translateX(-50%); border-radius:3px; background:currentColor; animation: scrollDot 1.6s ease-in-out infinite}
    @keyframes scrollDot{ 0%,100%{ transform: translate(-50%,0) } 50%{ transform: translate(-50%,10px) } }

    /* MESSAGE SECTION */
    .story{background:linear-gradient(180deg, transparent, rgba(255,255,255,.03)), radial-gradient(1000px 300px at 50% -120px, rgba(255,255,255,.06), transparent), var(--paper)}
    .story .wrap{display:grid; gap:1.25rem}
    .story p{font-size:1.05rem; opacity:.0; transform: translateY(8px); transition: transform .7s var(--ease), opacity .7s var(--ease)}
    .story p.is-visible{opacity:1; transform: translateY(0)}

    .decor{position:absolute; inset:auto auto -120px -40px; width:240px; height:240px; background: radial-gradient(closest-side, rgba(245,158,11,.35), transparent 70%); filter:blur(20px); mix-blend-mode:screen; pointer-events:none}

    /* HIGHLIGHTS */
    .highlights .grid{display:grid; grid-template-columns:1fr; gap:16px}
    @media(min-width:720px){ .highlights .grid{grid-template-columns:repeat(3,1fr)} }
    .card{position:relative; border-radius:var(--radius-lg); background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
          border:1px solid rgba(255,255,255,.18); padding:18px; backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
          box-shadow:var(--shadow-soft); transform-style:preserve-3d; transform: translateY(10px) scale(.98); opacity:0; transition: transform .7s var(--ease), opacity .7s var(--ease)}
    .card.is-visible{opacity:1; transform: translateY(0) scale(1)}
    .card:hover{transform: rotateX(6deg) rotateY(-6deg) translateZ(6px) scale(1.01)}
    .card .icon{width:40px; height:40px; margin-bottom:.5rem}
    .card h3{font-size:1.05rem; letter-spacing:.04em}
    .spec{position:absolute; inset:auto 10px 10px auto; width:120px; height:120px; background: conic-gradient(from 120deg, rgba(255,255,255,.14), transparent 60%);
          filter: blur(16px); opacity:.5; pointer-events:none}

    /* COUNTDOWN */
    .countdown{display:grid; place-items:center; gap:8px}
    .countdown .pill{display:inline-grid; grid-auto-flow:column; gap:10px; align-items:center; padding:10px 14px; border-radius:999px; border:1px solid rgba(255,255,255,.2); background:var(--glass)}
    .digits{display:grid; grid-auto-flow:column; gap:12px; font-variant-numeric: tabular-nums; letter-spacing:.06em; font-weight:700}
    .digits span{min-width:2ch; text-align:center}

    /* GALLERY */
    .gallery .grid{display:grid; grid-template-columns:1fr 1fr; gap:10px}
    @media(min-width:760px){ .gallery .grid{grid-template-columns:repeat(3,1fr)} }
    .ph{position:relative; overflow:hidden; border-radius:14px; transform:translateY(12px); opacity:0; transition:transform .8s var(--ease), opacity .8s var(--ease)}
    .ph.is-visible{transform:translateY(0); opacity:1}
    .ph img{display:block; width:100%; height:100%; object-fit:cover; filter:saturate(1.05)}
    .ph::after{content:""; position:absolute; inset:0; mask-image: radial-gradient(90% 70% at 50% 50%, #000 60%, transparent 80%); -webkit-mask-image: radial-gradient(90% 70% at 50% 50%, #000 60%, transparent 80%); box-shadow: inset 0 0 0 2px rgba(255,255,255,.14); border-radius:14px; pointer-events:none}
    .ph:hover img{transform:scale(1.03); transition: transform .6s var(--ease)}

    /* CLOSING / SURPRISE */
    .closing{display:grid; place-items:center; text-align:center; padding-bottom:120px}
    .closing .big{font-size: clamp(26px, 6vw, 46px); font-weight:900; letter-spacing:.03em; line-height:1.15; background: linear-gradient(100deg, var(--gold), var(--magenta), var(--sky));
                  background-clip:text; -webkit-background-clip:text; -webkit-text-fill-color:transparent; position:relative}
    .sweep{position:absolute; inset:0; background: linear-gradient(90deg, rgba(255,255,255,0), rgba(255,255,255,.9), rgba(255,255,255,0)); mix-blend-mode:screen; transform: translateX(-120%); filter: blur(6px)}
    .play{margin-top:14px; border:1px solid rgba(255,255,255,.3); background:var(--glass); padding:.7rem 1rem; border-radius:999px; cursor:pointer; box-shadow:var(--shadow-tiny)}
    .play:focus-visible{outline:2px solid var(--sky); outline-offset:3px}

    /* FOOTER */
    footer{padding:36px 0 48px; text-align:center; opacity:.8}
    .to-top{position:fixed; right:14px; bottom:14px; z-index:50; border-radius:999px; width:46px; height:46px; display:grid; place-items:center; border:1px solid rgba(255,255,255,.3); background:var(--glass); box-shadow:var(--shadow-tiny); opacity:0; transform:translateY(10px); pointer-events:none; transition:opacity .3s, transform .3s}
    .to-top.show{opacity:1; transform:translateY(0); pointer-events:auto}

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      *{animation-duration:.001ms !important; animation-iteration-count:1 !important; transition-duration: .001ms !important; scroll-behavior:auto !important}
      .card:hover{transform:none}
    }
  </style>
</head>
<body data-theme="dark">
  <a href="#main" class="sr-only">Saltar al contenido</a>
  <header class="site" role="banner" aria-label="Barra superior">
    <div class="wrap">
      <div class="brand" aria-label="Marca">
        <span class="dot" aria-hidden="true"></span>
        <span>Celebrando a Maria Antonia</span>
      </div>
      <button id="theme" class="toggle" aria-pressed="false" aria-label="Cambiar tema claro/oscuro">
        <span aria-hidden="true">🌓</span><span class="muted">Tema</span>
      </button>
    </div>
  </header>

  <main id="main" tabindex="-1">
    <!-- HERO -->
    <section class="hero section" aria-labelledby="t-hero">
      <div class="parallax" aria-hidden="true">
        <div class="layer stars" style="transform: translateZ(-60px);"></div>
        <div class="layer glow" style="transform: translateZ(-30px);"></div>
        <div class="layer balloons">
          <div class="balloon" style="transform: translateZ(-10px)"></div>
          <div class="balloon" style="transform: translateZ(-15px)"></div>
          <div class="balloon" style="transform: translateZ(-8px)"></div>
        </div>
        <div class="confetti" id="confetti" aria-hidden="true"></div>
      </div>
      <div class="hero-content wrap">
        <h1 id="t-hero" class="title" aria-live="polite">¡Feliz Cumpleaños, Maria Antonia!</h1>
        <p class="subtitle">Hoy celebramos tus 23 años</p>
      </div>
      <div class="scroll-hint" aria-hidden="true">
        <div class="chev"></div>
        <small class="muted">Desliza</small>
      </div>
    </section>

    <!-- STORY / MESSAGE -->
    <section class="story section" aria-label="Mensaje de cariño">
      <span class="decor" aria-hidden="true"></span>
      <div class="wrap">
        <p class="reveal">Que este nuevo año esté lleno de alegría genuina, metas cumplidas y momentos que te hagan sonreír con el alma.</p>
        <p class="reveal">Gracias por ser luz en la vida de quienes te rodean. Hoy celebramos tu historia, tu presente y todo lo bello que viene.</p>
      </div>
    </section>

    <!-- HIGHLIGHTS -->
    <section class="highlights section" aria-labelledby="t-high">
      <div class="wrap">
        <h2 id="t-high" class="center" style="letter-spacing:.06em">Pequeños Highlights</h2>
        <div class="grid" style="margin-top:16px">
          <article class="card reveal" role="article" aria-label="Tu sonrisa que ilumina">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 2a10 10 0 100 20 10 10 0 000-20Zm0 3a1.5 1.5 0 110 3 1.5 1.5 0 010-3Zm0 14a7 7 0 01-6.32-4h2.19A5 5 0 0012 17a5 5 0 004.13-2H18.3A7 7 0 0112 19Z"/></svg>
            <h3>Tu sonrisa que ilumina</h3>
            <p class="muted">Esa chispa que alegra días nublados y convierte momentos simples en memorables.</p>
            <i class="spec" aria-hidden="true"></i>
          </article>
          <article class="card reveal" role="article" aria-label="Tus sueños que crecen">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 3l7 4v6c0 5-7 8-7 8s-7-3-7-8V7l7-4Zm0 3.2L7 8v4.8c0 3.52 3.83 5.9 5 6.53 1.17-.63 5-3.01 5-6.53V8l-5-1.8Z"/></svg>
            <h3>Tus sueños que crecen</h3>
            <p class="muted">Paso a paso, constancia y corazón: lo mejor aún está por venir.</p>
            <i class="spec" aria-hidden="true"></i>
          </article>
          <article class="card reveal" role="article" aria-label="Tu energía que inspira">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M11 21h-1l1-7H7l6-11h1l-1 7h4l-6 11Z"/></svg>
            <h3>Tu energía que inspira</h3>
            <p class="muted">Tu presencia motiva, empuja y enciende nuevas ideas en todos.</p>
            <i class="spec" aria-hidden="true"></i>
          </article>
        </div>
      </div>
    </section>

    <!-- COUNTDOWN / TODAY NOTE -->
    <section class="countdown section" aria-live="polite">
      <div class="wrap center">
        <p id="today-note" class="muted"></p>
        <div class="pill">
          <strong class="muted">Cuenta atrás demo:</strong>
          <div class="digits" id="digits" aria-label="Cuenta atrás a medianoche">
            <span id="d-h">00</span>:
            <span id="d-m">00</span>:
            <span id="d-s">00</span>
          </div>
        </div>
      </div>
    </section>

    <!-- GALLERY (placeholders base64) -->
    <section class="gallery section" aria-labelledby="t-gal">
      <div class="wrap">
        <h2 id="t-gal" class="center" style="letter-spacing:.06em">Recuerdos</h2>
        <div class="grid" style="margin-top:16px">
          <figure class="ph reveal"><img loading="lazy" alt="Luz bokeh cálida" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0nNTAwJyBoZWlnaHQ9JzQwMCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJz48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9J2cnIHgxPScwJyB5MT0nMCcgeDI9JzEnIHkyPScxJz48c3RvcCBvZmZzZXQ9JzAnIHN0b3AtY29sb3I9JyNmNGQxOTYnLz48c3RvcCBvZmZzZXQ9JzEnIHN0b3AtY29sb3I9JyNlZWM2YjMnLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cmVjdCB3aWR0aD0nMTAwJScgaGVpZ2h0PScxMDAlJyBmaWxsPSJ1cmwoI2cpIi8+PC9zdmc+"/></figure>
          <figure class="ph reveal"><img loading="lazy" alt="Globos y destellos" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0nNTAwJyBoZWlnaHQ9JzQwMCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJz48Y2lyY2xlIGN4PScxNTAnIGN5PScxNTAiIHI9JzgwJyBmaWxsPSIjZWE3OWY5Ii8+PGNpcmNsZSBjeD0nMzUwJyBjeT0nMjUwJyByPSc2MCcgZmlsbD0iI2Y1OWUwYiIvPjwvc3ZnPg=="/></figure>
          <figure class="ph reveal"><img loading="lazy" alt="Cielo en tonos magenta" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0nNTAwJyBoZWlnaHQ9JzQwMCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJz48bGluZWFyR3JhZGllbnQgaWQ9J2EnIHgxPScwJyB5MT0nMCcgeDI9JzEnIHkyPScxJz48c3RvcCBvZmZzZXQ9JzAnIHN0b3AtY29sb3I9IiNmOGE1ZTAiLz48c3RvcCBvZmZzZXQ9JzEnIHN0b3AtY29sb3I9IiMzOGJkZjgiLz48L2xpbmVhckdyYWRpZW50PjxyZWN0IHdpZHRoPScxMDAlJyBoZWlnaHQ9JzEwMCUnIGZpbGw9InVybCgjYSkiLz48L3N2Zz4="/></figure>
          <figure class="ph reveal"><img loading="lazy" alt="Confeti difuso" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0nNTAwJyBoZWlnaHQ9JzQwMCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJz48cmVjdCB3aWR0aD0nMTAwJScgaGVpZ2h0PScxMDAlJyBmaWxsPSIjMGYxNzJhIi8+PGNpcmNsZSBjeD0nNDAiIGN5PScyMDAiIHI9JzEwJyBmaWxsPSIjZWE3OWY5Ii8+PGNpcmNsZSBjeD0nMjgwJyBjeT0nMzAnIHI9JzgnIGZpbGw9IiNmNTllMGIiLz48Y2lyY2xlIGN4PSc0NDAiIGN5PSczMjAnIHI9JzEwJyBmaWxsPSIjMzhiZGY4Ii8+PC9zdmc+"/></figure>
          <figure class="ph reveal"><img loading="lazy" alt="Brillos suaves" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0nNTAwJyBoZWlnaHQ9JzQwMCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJz48ZGVmcz48cmFkaWFsR3JhZGllbnQgaWQ9InIiIGN4PSI1MCUiIGN5PSI1MCUiIHI9IjYwJSI+PHN0b3Agb2Zmc2V0PSIuMCIgc3RvcC1jb2xvcj0iI2VlZWUiLz48c3RvcCBvZmZzZXQ9Ii45IiBzdG9wLWNvbG9yPSJyZ2JhKDI1NSwyNTUsMjU1LDApIi8+PC9yYWRpYWxHcmFkaWVudD48L2RlZnM+PGNpcmNsZSBjeD0iNTAiIGN5PSI0MCIgcj0iNDAiIGZpbGw9InVybCgjcikiIG9wYWNpdHk9Ii40Ii8+PC9zdmc+"/></figure>
          <figure class="ph reveal"><img loading="lazy" alt="Destello dorado" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0nNTAwJyBoZWlnaHQ9JzQwMCcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48bGluZWFyR3JhZGllbnQgaWQ9ImQiIHgxPSIwIiB5MT0iMCIgeDI9IjEiIHkyPSIxIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiNmNWFlMmIiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNmZmVjY2UiLz48L2xpbmVhckdyYWRpZW50PjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZCkiLz48L3N2Zz4="/></figure>
        </div>
      </div>
    </section>

    <!-- CLOSING -->
    <section class="closing section" aria-label="Buenos deseos y firma">
      <div class="wrap">
        <h2 class="big" id="final-text">Brilla siempre, Maria Antonia — feliz 23<div class="sweep" id="sweep" aria-hidden="true"></div></h2>
        <p class="muted">Con cariño, tu familia y amigos.</p>
        <button id="surprise" class="play" aria-controls="fx" aria-expanded="false">Reproducir sorpresa ✨</button>
      </div>
      <canvas id="fx" width="600" height="300" style="position:absolute; inset:0; width:100%; height:100%; pointer-events:none;"></canvas>
    </section>
  </main>

  <button class="to-top" id="toTop" aria-label="Volver arriba">↑</button>
  <footer class="wrap">
    <small>Hecho con ♥ para celebrar a Maria Antonia.</small>
  </footer>

  <script>
  (function(){
    const body = document.body;
    // THEME TOGGLE
    const themeBtn = document.getElementById('theme');
    const saved = localStorage.getItem('theme');
    if(saved){ body.setAttribute('data-theme', saved); themeBtn.setAttribute('aria-pressed', String(saved==='dark')); }
    themeBtn.addEventListener('click', ()=>{
      const cur = body.getAttribute('data-theme')==='dark' ? 'light' : 'dark';
      body.setAttribute('data-theme', cur);
      localStorage.setItem('theme', cur);
      themeBtn.setAttribute('aria-pressed', String(cur==='dark'));
    });

    // PARALLAX (rAF single loop)
    const parRoot = document.querySelector('.parallax');
    const layers = [...document.querySelectorAll('.layer')];
    let y=0; let ticking=false;
    const onScroll = ()=>{ y = window.scrollY || window.pageYOffset; if(!ticking){ requestAnimationFrame(update); ticking=true; }};
    function update(){
      const d = Math.min(1, (y/600)); // damp
      layers.forEach((el,i)=>{
        const depth = [-60,-30,-10,0][i] || -8; // fallback depth
        el.style.transform = `translateZ(${depth}px) translateY(${d* (i===0? -8: i===1? -14: -10)}px)`;
      });
      ticking=false;
    }
    document.addEventListener('scroll', onScroll, {passive:true}); update();

    // CONFETTI (DOM subtle)
    const conf = document.getElementById('confetti');
    const colors = ['#F59E0B','#E879F9','#38BDF8','#ffffff'];
    for(let i=0;i<24;i++){
      const p=document.createElement('i'); p.className='piece'; conf.appendChild(p);
      p.style.left = (Math.random()*100)+'%';
      p.style.top = (-Math.random()*80)+'vh';
      p.style.background = colors[i%colors.length];
      p.style.animationDuration = (6 + Math.random()*6)+'s';
      p.style.animationDelay = (-Math.random()*6)+'s';
      p.style.transform = `translateY(${(-20 - Math.random()*60)}vh) rotate(${Math.random()*180}deg)`;
      p.style.opacity = 0.4 + Math.random()*0.5;
      p.style.width = (4+Math.random()*4)+'px';
      p.style.height = (8+Math.random()*8)+'px';
    }

    // INTERSECTION OBSERVER (stagger reveal)
    const io = new IntersectionObserver((entries)=>{
      entries.forEach((e)=>{
        if(e.isIntersecting){
          const items = e.target.querySelectorAll('.reveal');
          if(items.length){ items.forEach((el,idx)=> setTimeout(()=>el.classList.add('is-visible'), 120*idx)); }
          else{ e.target.classList.add('is-visible'); }
          io.unobserve(e.target);
        }
      })
    }, {threshold:.2});

    document.querySelectorAll('.story .wrap, .card, .ph').forEach(el=> io.observe(el.closest('.story .wrap') || el));

    // ToTop button
    const toTop = document.getElementById('toTop');
    const onToTop = ()=>{ if(window.scrollY>300){toTop.classList.add('show')} else {toTop.classList.remove('show')} };
    document.addEventListener('scroll', onToTop, {passive:true}); onToTop();
    toTop.addEventListener('click', ()=> window.scrollTo({top:0, behavior:'smooth'}));

    // COUNTDOWN (demo to midnight)
    const dh = document.getElementById('d-h');
    const dm = document.getElementById('d-m');
    const ds = document.getElementById('d-s');
    const note = document.getElementById('today-note');
    const now = new Date();
    const midnight = new Date(now); midnight.setHours(24,0,0,0);
    note.textContent = `Hoy es ${now.toLocaleDateString(undefined,{weekday:'long', year:'numeric', month:'long', day:'numeric'})}`;
    function tick(){
      const t = Math.max(0, midnight - new Date());
      const s = Math.floor(t/1000)%60;
      const m = Math.floor(t/60000)%60;
      const h = Math.floor(t/3600000);
      dh.textContent = String(h).padStart(2,'0');
      dm.textContent = String(m).padStart(2,'0');
      ds.textContent = String(s).padStart(2,'0');
      requestAnimationFrame(tick);
    }
    tick();

    // SURPRISE (canvas particles + sweep)
    const btn = document.getElementById('surprise');
    const canvas = document.getElementById('fx');
    const ctx = canvas.getContext('2d');
    let w,h,particles=[],playing=false;
    function resize(){ w = canvas.width = canvas.clientWidth * devicePixelRatio; h = canvas.height = canvas.clientHeight * devicePixelRatio; }
    new ResizeObserver(resize).observe(canvas); resize();

    function makeParticle(){
      const angle = Math.random()*Math.PI*2;
      const speed = 1 + Math.random()*3;
      particles.push({
        x:w/2, y:h*.6, vx: Math.cos(angle)*speed, vy: Math.sin(angle)*speed - 2,
        life: 60 + Math.random()*60, color: colors[Math.floor(Math.random()*colors.length)], size: 2 + Math.random()*3
      });
    }

    function loop(){
      if(!playing) return;
      ctx.clearRect(0,0,w,h);
      for(let i=0;i<6;i++) makeParticle();
      particles.forEach(p=>{
        p.vy += 0.04 * devicePixelRatio; p.vx *= .995; p.vy *= .995; p.x += p.vx; p.y += p.vy; p.life -= 1;
        ctx.globalCompositeOperation='lighter';
        ctx.fillStyle=p.color; ctx.beginPath(); ctx.arc(p.x,p.y,p.size*devicePixelRatio,0,Math.PI*2); ctx.fill();
      });
      particles = particles.filter(p=> p.life>0 && p.y<h+20);
      requestAnimationFrame(loop);
    }

    const sweep = document.getElementById('sweep');
    btn.addEventListener('click', ()=>{
      playing = !playing; btn.setAttribute('aria-expanded', String(playing));
      if(playing){
        sweep.animate({ transform:['translateX(-120%)','translateX(120%)'] }, { duration:1400, easing:'cubic-bezier(.2,.6,.2,1)' });
        loop();
      }
    });

  })();
  </script>
</body>
</html>
